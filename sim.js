var sim=function(f){function g(a){return a?f.getElementById(a):f.body}function l(a,b,d){var h,e=f.createEventObject?f.createEventObject():f.createEvent("Events");e.initEvent&&e.initEvent(b,!0,!0);for(h in d)e[h]=d[h];a.dispatchEvent?a.dispatchEvent(e):a.fireEvent("on"+b,e)}function n(a){return function(){this.steps.push([a].concat([].slice.call(arguments)));return this}}function k(a,b,d,h,e,c){p(function(){var e=!1,f="";try{(e=a.apply({},b)||!c)&&d&&d()}catch(g){f=g.message}e||(c>+new Date?k(a,b,d,h,100,c):h(f))},e)}function q(a,b,d){function h(a){c.a="sim failed at step "+(c.index+1)+": "+a;c.fail&&c.fail(c)}function e(b,f){if(b)k(b,[],e,h,0,+new Date+(f||-1));else{d&&-1<c.index&&d(c);var g=c.steps[++c.index];c.index<c.steps.length?k(m[g[0]],[g,e],!1,h,c.wait):(c.index=-1,a&&a(c))}}var c=this;b&&(c.fail=b);e()}var p=setTimeout,m={hash:function(a,b){window.location.hash=a[1];b(a[2],a[3])},test:function(a,b){b(a[1],a[2])},fire:function(a,b){l(g(a[1]),a[2],a[3]);b()},click:function(a,b){var d=g(a[1]);"checked"in d&&(d.checked="radio"==d.type?!0:!d.checked);l(g(a[1]),"click");b()},write:function(a,b){g(a[1]).value=a[2];b()}};return function(a){var b;a={wait:a||0,steps:[],index:-1,run:q,fail:function(a){console&&console.log&&console.log(a.a)}};for(b in m)a[b]=n(b);return a}}(document);
